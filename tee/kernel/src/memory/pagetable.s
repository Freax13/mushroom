.section .pagetables, "aw"

.set PTE_PRESENT, 1 << 0
.set PTE_WRITABLE, 1 << 1
.set PTE_HUGE, 1 << 7
.set PTE_NO_EXECUTE, 1 << 63

.align 4096
pml4:
.fill 256, 8, 0 
.quad pdp_256 + PTE_PRESENT + PTE_WRITABLE
.fill 253, 8, 0 
.quad pml4 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE
.quad 0

.align 4096
pdp_256:
.quad pd_256_0 + PTE_PRESENT + PTE_WRITABLE
.fill 511, 8, 0

.align 4096
pd_256_0:
# reset_vector
.quad 0x10040000000 + PTE_PRESENT + PTE_HUGE
# text
.quad 0x10040200000 + PTE_PRESENT + PTE_HUGE
.quad 0x10040400000 + PTE_PRESENT + PTE_HUGE
.quad 0x10040600000 + PTE_PRESENT + PTE_HUGE
.quad 0x10040800000 + PTE_PRESENT + PTE_HUGE
.quad 0x10040a00000 + PTE_PRESENT + PTE_HUGE
.quad 0x10040c00000 + PTE_PRESENT + PTE_HUGE
.quad 0x10040e00000 + PTE_PRESENT + PTE_HUGE
# rodata
.quad 0x10080000000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10080200000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10080400000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10080600000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10080800000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10080a00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10080c00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10080e00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
# data
.quad 0x100c0000000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x100c0200000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x100c0400000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x100c0600000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x100c0800000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x100c0a00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x100c0c00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x100c0e00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
# tdata
.quad 0x10100000000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10100200000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10100400000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10100600000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10100800000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10100a00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10100c00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10100e00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
# stack
.quad 0x10140000000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10140200000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10140400000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10140600000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10140800000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10140a00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10140c00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x10140e00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.fill 472, 8, 0

.section .stack, "aw"
stack:
.fill 4 * 4096, 1, 0
stack_end:
