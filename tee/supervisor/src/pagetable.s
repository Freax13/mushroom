.section .pagetables, "aw"

.set PTE_PRESENT, 1 << 0
.set PTE_WRITABLE, 1 << 1
.set PTE_DIRTY, 1 << 6
.set PTE_HUGE, 1 << 7
.set PTE_NO_EXECUTE, 1 << 63

.global private_pagetables_start
private_pagetables_start:

.align 4096
.global pml4
pml4:
.quad pdp_0 + PTE_PRESENT + PTE_WRITABLE
.fill 127, 8, 0
.quad pdp_128 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE
.fill 382, 8, 0
.quad pml4 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE

.align 4096
pdp_0:
.quad 0
.quad pd_0_0 + PTE_PRESENT + PTE_WRITABLE
.quad 0
.quad pd_0_3 + PTE_PRESENT + PTE_WRITABLE
.fill 508, 8, 0

.align 4096
pd_0_3:
.fill 509, 8, 0
.quad 0x000ffa00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x000ffc00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x000ffe00000 + PTE_PRESENT + PTE_HUGE

.align 4096
pdp_128:
.quad pd_128_0 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE
.fill 511, 8, 0

.align 4096
pd_128_0:
.quad pt_128_0_0 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE
.quad 0 # This page is used for temporary 2MiB mappings.
.fill 510, 8, 0

.align 4096
pt_128_0_0:
.quad 0 # This page is used for temporary 4KiB mappings.
.fill 511, 8, 0

.align 4096
pd_0_0:
.quad 0x00100000000 + PTE_PRESENT + PTE_HUGE
.quad 0x00100200000 + PTE_PRESENT + PTE_HUGE
.quad 0x00100400000 + PTE_PRESENT + PTE_HUGE
.quad 0x00100600000 + PTE_PRESENT + PTE_HUGE
.quad 0x00100800000 + PTE_PRESENT + PTE_HUGE
.quad 0x00100a00000 + PTE_PRESENT + PTE_HUGE
.quad 0x00100c00000 + PTE_PRESENT + PTE_HUGE
.quad 0x00100e00000 + PTE_PRESENT + PTE_HUGE
.quad 0x00140000000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00140200000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00140400000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00140600000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00140800000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00140a00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00140c00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00140e00000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180000000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180200000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180400000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180600000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180800000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180a00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180c00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0x00180e00000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0
.quad 0x001c0000000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.quad 0
.quad 0x00200000000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_HUGE
.quad 0
.quad 0x00240000000 + PTE_PRESENT + PTE_NO_EXECUTE + PTE_DIRTY + PTE_HUGE
.quad 0
.quad 0
.global private_pagetables_end
private_pagetables_end:
.quad 0x00280000000 + PTE_PRESENT + PTE_WRITABLE + PTE_NO_EXECUTE + PTE_HUGE
.fill 479, 8, 0
